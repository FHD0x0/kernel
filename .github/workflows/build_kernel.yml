name: Build Android Kernel

on:
  push:
    branches:
      - main  # أو يمكنك تحديد أي فرع ترغب في مراقبته، مثل master أو develop.
  workflow_dispatch:  # يتيح لك تشغيل الـ workflow يدويًا عبر واجهة GitHub.

jobs:
  build:
    runs-on: ubuntu-24.04  # اختيار بيئة العمل المناسبة (Ubuntu هنا)

    steps:
      # 1. تحميل الكود المصدر للكيرنل من مستودعك
      - name: Checkout kernel source
        uses: actions/checkout@v2

      # 2. تحميل AnyKernel3 (اختياري، لكنه مهم إذا كنت تستخدم قالب AnyKernel3 لإنشاء ملف مضغوط قابل للتثبيت)
      - name: Checkout AnyKernel3 template
        uses: actions/checkout@v2
        with:
          repository: lemniskett/AnyKernel3
          path: zipper

      # 3. بناء الكيرنل
      - name: Android kernel build
  uses: lemniskett/android-kernel-actions@master
  id: build
  env:
    NAME: Dark-Ages-Último
  with:
    arch: arm64
    compiler: gcc/10
    defconfig: kernel/arch/arm64/configs/vendor/y2q_chn_hkx_defconfig  # المسار الكامل لملف defconfig
    image: Image.gz-dtb

      # 4. نشر البناء
      - name: Release build
        uses: ncipollo/release-action@v1  # استخدام الإجراء لنشر الملف الناتج
        with:
          artifacts: ${{ steps.build.outputs.outfile }}
          token: ${{ secrets.GITHUB_TOKEN }}  # استخدم الـ GitHub Token للمصادقة

